---
layout: post
title: Create Custom Test Category Attributes in Visual Studio
date: 
type: post
parent_id: '0'
published: false
password: ''
status: draft
categories: []
tags: []
meta:
  blogger_blog: toddmeinershagen.blogspot.com
  blogger_author: Todd Meinershagen
  blogger_afd108f81ae242501ffa65d49d9298e0_permalink: '6158494910193984410'
  _publicize_job_id: '11181715884'
author:
  login: tmeinershagen
  email: todd@meinershagen.net
  display_name: Todd Meinershagen
  first_name: ''
  last_name: ''
---
<p>In the past, for each class library project we create in Visual Studio, we have maintained separate unit test and integration test projects.  This has allowed us to easily configure continuous integration with TFS to run a given project’s unit tests on check-in and run the full suite of unit and integration tests on a nightly build.<br />With the introduction of Visual Studio 2010, build types now can filter tests based on test categories. </p>
<p>For example, I can categorize a given test as a unit test by doing the following:</p>
<p>        <span style="font-family:COnsolas;">[TestClass]     <br />    public class Test      <br />    {      <br />        [TestMethod]      <br />        [TestCategory("UnitTest")]      <br />        public void IsValid_returns_false_when_quantity_large()      <br />        {      <br />        }      <br />    }</span><br /><span style="font-family:COnsolas;"><br /></span><br />This allows us to consolidate all tests into one project and distinguish by categories.  The only issue is that these categories are based on strings that the developer must type, and this can create inconsistencies using magic strings which may not be noticed during the course of development.</p>
<p>In order to get around this, another option is to create your own custom test category attributes that return the proper string.  Microsoft has provided a base class, TestCategoryBaseAttribute for this very purpose.</p>
<p>         <span style="font-family:Consolas;">public class UnitTestAttribute : TestCategoryBaseAttribute     <br />    {      <br />        public UnitTestAttribute()      <br />        {} </span><br /><span style="font-family:Consolas;">        public override IList TestCategories     <br />        {      <br />            get { return new List {"UnitTest"}; }      <br />        }      <br />    }</span></p>
<p>By overriding the TestCategories property, you can return the appropriate string(s) that represent this classification.  In this case, we are returning the same string that the previous test category provided.</p>
<p>In order to use this attribute, you merely need to add it to a given test method like so.</p>
<p>        <span style="font-family:Consolas;">[TestClass]     <br />    public class Test      <br />    {      <br />        [TestMethod]      <br />        [UnitTest]      <br />        public void IsValid_returns_false_when_quantity_large()      <br />        {      <br />        }      <br />    }</span></p>
<p>With this kind of flexibility, if you had a limited list of attributes that you wanted to provide to developers, you could also create an enum type and pass that into the constructor of the custom test category attribute.  </p>
<p>Just create an enum type.</p>
<p>         <span style="font-family:Consolas;">public enum Category : int     <br />    {      <br />        UnitTest = 0,      <br />        IntegrationTest = 1      <br />    }</span></p>
<p>Then, create the attribute using the enum as a constructor parameter.</p>
<p>         <span style="font-family:Consolas;">public class TestCategoryAttribute </span><span style="font-family:Consolas;">: TestCategoryBaseAttribute     <br />    {      <br />        private TestCategory _category; </span><br /><span style="font-family:Consolas;">        </span><br /><span style="font-family:Consolas;">        public TestCategoryAttribute(TestCategory category)     <br />        {      <br />            _category = category;      <br />        } </span><br /><span style="font-family:Consolas;">        </span><br /><span style="font-family:Consolas;">        public override IList TestCategories     <br />        {      <br />            get      <br />            {      <br />                var value = Enum.GetName(typeof (TestCategory), _category);      <br />                return new List{ value };      <br />            }      <br />        }      <br />    }</span><br /><span style="font-family:Consolas;"><br /></span><br />To use the new attribute, you would do the following.</p>
<p>        <span style="font-family:Consolas;">[TestClass]     <br />    public class Test      <br />    {      <br />        [TestMethod]      <br />        [TestCategory(Category.UnitTest)]      <br />        public void IsValid_returns_false_when_quantity_large()      <br />        {      <br />        }      <br />    }</span></p>
<p>Hope this helps!
<div class="blogger-post-footer">
<div>
<br />
<span style="border-top:solid 1px #000000;"><br />
<span style="text-align:left;"><br />
Todd Meinershagen is a Principal Consultant with </span><a href="http://www.improvingenterprises.com/" style="text-align:left;">Improving Enterprises</a><span style="text-align:left;"> in Dallas, Texas.</span><br />
</span><br />

</div>
</div>
